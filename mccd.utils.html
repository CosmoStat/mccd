

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1.1.7. mccd.utils module &mdash; mccd 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="1.1.6. mccd.proxs module" href="mccd.proxs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mccd
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="mccd.html">1. mccd package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mccd.auxiliary_fun.html">1.1.1. mccd.auxiliary_fun module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.grads.html">1.1.2. mccd.grads module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.info.html">1.1.3. mccd.info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.mccd.html">1.1.4. mccd.mccd module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.mccd_utils.html">1.1.5. mccd.mccd_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.proxs.html">1.1.6. mccd.proxs module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.1.7. mccd.utils module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mccd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="mccd.html"><span class="section-number">1. </span>mccd package</a> &raquo;</li>
        
      <li><span class="section-number">1.1.7. </span>mccd.utils module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/mccd.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mccd.utils">
<span id="mccd-utils-module"></span><h1><span class="section-number">1.1.7. </span>mccd.utils module<a class="headerlink" href="#module-mccd.utils" title="Permalink to this headline">¶</a></h1>
<p>UTILS.</p>
<p>These functions include several functions needed by PSF modelling algorithms.</p>
<dl class="field-list">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Morgan Schmitz &lt;<a class="reference external" href="https://github.com/MorganSchmitz">https://github.com/MorganSchmitz</a>&gt;</p>
<p>Tobias Liaudat &lt;<a class="reference external" href="mailto:tobias&#46;liaudat&#37;&#52;&#48;cea&#46;fr">tobias<span>&#46;</span>liaudat<span>&#64;</span>cea<span>&#46;</span>fr</a>&gt;</p>
</dd>
</dl>
<dl class="py function">
<dt id="mccd.utils.apply_transform">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">apply_transform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#apply_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.apply_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform <code class="docutils literal notranslate"><span class="pre">data</span></code> through application of a set of filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – Data to be transformed. Should be in rca_format, where the image
index is contained
on last/2nd axis, ie (n_pix,n_pix,n_images).</p></li>
<li><p><strong>filters</strong> (<em>numpy.ndarray</em>) – Set of filters. Usually the wavelet transform filters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.acc_sig_maps">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">acc_sig_maps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shap_im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ker_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upfact</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#acc_sig_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.acc_sig_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply acc_sig_map() several times.</p>
<p>Calls:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">utils.acc_sig_map()</span></code></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.acc_sig_map">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">acc_sig_map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shap_im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ker_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upfact</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#acc_sig_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.acc_sig_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the simga noise maps from the observed data.</p>
<p>Computes the square root of
<span class="math notranslate nohighlight">\(\mathcal{F}^{2*}(\hat\sigma^2)(A^\top\odot A^\top)\)</span>.
See equation (27) in RCA paper (Ngole et al.).</p>
<p class="rubric">Notes</p>
<p><span class="math notranslate nohighlight">\(\mathrm{Var}(B)\)</span> has been replaced by the noise level as
estimated from the data, and here we do not have the term
<span class="math notranslate nohighlight">\(\mu\)</span> (gradient step size in the paper).</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.return_neighbors">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">return_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#return_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.return_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the nearest neighbors locally in one ccd.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.rca_format">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">rca_format</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#rca_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.rca_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch from <code class="docutils literal notranslate"><span class="pre">regular</span></code> format to <code class="docutils literal notranslate"><span class="pre">RCA</span></code> format.</p>
<p>RCA format: image index is contained on last axis [:,:,it]
Regular format: image index is contained on first axis [it,:,:]</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.reg_format">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">reg_format</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rca_cube</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#reg_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.reg_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch from <code class="docutils literal notranslate"><span class="pre">RCA</span></code> format to <code class="docutils literal notranslate"><span class="pre">regular</span></code> format.</p>
<p>RCA format: image index is contained on last axis [:,:,it]
Regular format: image index is contained on first axis [it,:,:]</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.decim">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">decim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">av_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#decim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.decim" title="Permalink to this definition">¶</a></dt>
<dd><p>Decimate image to lower resolution.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.pairwise_distances">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">pairwise_distances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#pairwise_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.pairwise_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute pairwise distances.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.transpose_decim">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">transpose_decim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decim_fact</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">av_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#transpose_decim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.transpose_decim" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the transpose of the decimation matrix.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.SoftThresholding">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">SoftThresholding</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#SoftThresholding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.SoftThresholding" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform element-wise soft thresholding.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.HardThresholding">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">HardThresholding</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#HardThresholding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.HardThresholding" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform element-wise hard thresholding.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.kthresholding">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">kthresholding</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#kthresholding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.kthresholding" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply k-thresholding.</p>
<p>Keep only <code class="docutils literal notranslate"><span class="pre">k</span></code> highest values and set the rest to 0.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.lineskthresholding">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">lineskthresholding</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#lineskthresholding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.lineskthresholding" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply k-thresholding to each line of input matrix.</p>
<p>Calls:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">utils.kthresholding()</span></code></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.mad">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">mad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#mad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.mad" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MAD (Median Absolute Deviation).</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.transform_mask">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">transform_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#transform_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.transform_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate bad pixels to 1st wavelet scale and mask all pixels affected.</p>
<p>Bad pixels are the ones with weight 0.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.lanczos">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">lanczos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.lanczos" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate Lanczos kernel for a given shift.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.flux_estimate">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">flux_estimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#flux_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.flux_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate flux for one image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>numpy.ndarray</em>) – Image stamp containing the star.</p></li>
<li><p><strong>cent</strong> (<em>numpy.ndarray</em>) – Centroid of the star. If not provided, the centroid is calculated.
Default is None.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Size of the star in sigma that will be used to calculate the flux and
possibly the centroid too.
Default is 4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>flux</strong> – Photometric flux value of the star.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See SPRITE paper (Ngole et al.), section 3.4.1.,
subsection ‘Photometric flux’.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.flux_estimate_stack">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">flux_estimate_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#flux_estimate_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.flux_estimate_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate flux for a bunch of images.</p>
<p>Calls:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">utils.flux_estimate()</span></code></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.shift_ker_stack">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">shift_ker_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upfact</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lanc_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#shift_ker_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.shift_ker_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate shifting kernels and rotated shifting kernels.</p>
<p>Calls:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">utils.lanczos()</span></code></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.gen_Pea">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">gen_Pea</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#gen_Pea"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.gen_Pea" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the graph Laplacian for a given set of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distances</strong> (<em>numpy.ndarray</em>) – Array of pairwise distances</p></li>
<li><p><strong>e</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Exponent to which the pairwise distances should be raised.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Constant multiplier along Laplacian’s diagonal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Pea</strong> – Graph laplacian.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Computes <span class="math notranslate nohighlight">\(P_{e,a}\)</span> matrix for given <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code> couple.
See Equations (16-17) in RCA paper (Ngole et al.).
Watch out with the <code class="docutils literal notranslate"><span class="pre">e</span></code> parameter as it plays a vital role in the graph
definition as it is a parameter of the distance that defines the
graph’s weights.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.select_vstar">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">select_vstar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigenvects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#select_vstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.select_vstar" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick best eigenvector from a set of <span class="math notranslate nohighlight">\((e,a)\)</span>.</p>
<p>i.e., solve (35) from RCA paper (Ngole et al.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigenvects</strong> (<em>numpy.ndarray</em>) – Array of eigenvects to be tested over.</p></li>
<li><p><strong>R</strong> (<em>numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(R_i\)</span> matrix.</p></li>
<li><p><strong>weights</strong> (<em>numpy.ndarray</em>) – Entry-wise weights for <span class="math notranslate nohighlight">\(R_i\)</span>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="mccd.utils.GraphBuilder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">GraphBuilder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_comp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_eigenvects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ea_gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#GraphBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.GraphBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>GraphBuilder class.</p>
<p>This class computes the necessary quantities for RCA’s graph constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_data</strong> (<em>numpy.ndarray</em>) – Observed data.</p></li>
<li><p><strong>obs_pos</strong> (<em>numpy.ndarray</em>) – Corresponding positions.</p></li>
<li><p><strong>obs_weights</strong> (<em>numpy.ndarray</em>) – Corresponding per-pixel weights.</p></li>
<li><p><strong>n_comp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of RCA components.</p></li>
<li><p><strong>n_eigenvects</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Maximum number of eigenvectors to consider per <span class="math notranslate nohighlight">\((e,a)\)</span> couple.
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>;
if not provided, <em>all</em> eigenvectors will be considered,
which can lead to a poor selection of graphs, especially when data
is undersampled.
Ignored if <code class="docutils literal notranslate"><span class="pre">VT</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha</span></code> are provided.</p></li>
<li><p><strong>n_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – How many alternations should there be when optimizing over
<span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(a\)</span>. Default is 3.</p></li>
<li><p><strong>ea_gridsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – How fine should the logscale grid of <span class="math notranslate nohighlight">\((e,a)\)</span> values be.
Default is 10.</p></li>
<li><p><strong>distances</strong> (<em>numpy.ndarray</em>) – Pairwise distances for all positions. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>;
if not provided, will be computed from given positions.</p></li>
<li><p><strong>auto_run</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to immediately build the graph quantities.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Initialize class attributes.</p>
<dl class="py method">
<dt id="mccd.utils.GraphBuilder.pick_emax">
<code class="sig-name descname"><span class="pre">pick_emax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#GraphBuilder.pick_emax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.GraphBuilder.pick_emax" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick maximum value for <code class="docutils literal notranslate"><span class="pre">e</span></code> parameter.</p>
<p>From now, we fix the maximum <span class="math notranslate nohighlight">\(e\)</span> to 1 and ignore the old
procedure that was giving values that were too big.</p>
<p>Old procedure:
Select maximum value of <span class="math notranslate nohighlight">\(e\)</span> for the greedy search over set of
<span class="math notranslate nohighlight">\((e,a)\)</span> couples, so that the graph is still fully connected.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.utils.GraphBuilder.select_params">
<code class="sig-name descname"><span class="pre">select_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_range</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#GraphBuilder.select_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.GraphBuilder.select_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Select best graph parameters.</p>
<p>Select <span class="math notranslate nohighlight">\((e,a)\)</span> parameters and best eigenvector
for current <span class="math notranslate nohighlight">\(R_i\)</span> matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<em>numpy.ndarray</em>) – Current <span class="math notranslate nohighlight">\(R_i\)</span> matrix
(as defined in RCA paper (Ngole et al.), sect. 5.5.3.)</p></li>
<li><p><strong>e_range</strong> (<em>numpy.ndarray</em>) – List of <span class="math notranslate nohighlight">\(e\)</span> values to be tested.</p></li>
<li><p><strong>a_range</strong> (<em>numpy.ndarray</em>) – List of <span class="math notranslate nohighlight">\(a\)</span> values to be tested.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.utils.GraphBuilder.gen_eigenvects">
<code class="sig-name descname"><span class="pre">gen_eigenvects</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#GraphBuilder.gen_eigenvects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.GraphBuilder.gen_eigenvects" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute input matrix’s eigenvectors.</p>
<p>Keep only the <code class="docutils literal notranslate"><span class="pre">n_eigenvects</span></code> associated
with the smallest eigenvalues.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mccd.utils.poly_pos">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">poly_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#poly_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.poly_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct polynomial matrix.</p>
<p>Return a matrix Pi containing polynomials of stars
positions up to <code class="docutils literal notranslate"><span class="pre">max_degree</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt id="mccd.utils.CentroidEstimator">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">CentroidEstimator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#CentroidEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.CentroidEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Estimate intra-pixel shifts.</p>
<p>It calculates the centroid of the image and compare it with the stamp
centroid and returns the proper shift.
The star centroid is calculated following an iterative procedure where a
matched elliptical gaussian is used to calculate the moments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>numpy.ndarray</em>) – Star image stamp.</p></li>
<li><p><strong>sig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Estimated shape of the star in sigma.
Default is 7.5.</p></li>
<li><p><strong>n_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Max iteration number for the iterative estimation procedure.
Default is 5.</p></li>
<li><p><strong>auto_run</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Auto run the intra-pixel shif calculation in the initialization
of the class.
Default is True.</p></li>
<li><p><strong>xc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – First guess of the <code class="docutils literal notranslate"><span class="pre">x</span></code> component of the star centroid. (optional)
Default is None.</p></li>
<li><p><strong>yc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – First guess of the <code class="docutils literal notranslate"><span class="pre">y</span></code> component of the star centroid. (optional)
Default is None.</p></li>
</ul>
</dd>
</dl>
<p>Initialize class attributes.</p>
<dl class="py method">
<dt id="mccd.utils.CentroidEstimator.UpdateGrid">
<code class="sig-name descname"><span class="pre">UpdateGrid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#CentroidEstimator.UpdateGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.CentroidEstimator.UpdateGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the grid where the star stamp is defined.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.utils.CentroidEstimator.EllipticalGaussian">
<code class="sig-name descname"><span class="pre">EllipticalGaussian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#CentroidEstimator.EllipticalGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.CentroidEstimator.EllipticalGaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an elliptical 2D gaussian with arbitrary centroid.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.utils.CentroidEstimator.ComputeMoments">
<code class="sig-name descname"><span class="pre">ComputeMoments</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#CentroidEstimator.ComputeMoments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.CentroidEstimator.ComputeMoments" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the star moments.</p>
<p>Compute the star image normalized first order moments with
the current window function.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.utils.CentroidEstimator.estimate">
<code class="sig-name descname"><span class="pre">estimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#CentroidEstimator.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.CentroidEstimator.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the star image centroid iteratively.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.utils.CentroidEstimator.return_shifts">
<code class="sig-name descname"><span class="pre">return_shifts</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#CentroidEstimator.return_shifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.CentroidEstimator.return_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return intra-pixel shifts.</p>
<p>Intra-pixel shifts are the difference between
the estimated centroid and the center of the stamp (or pixel grid).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mccd.utils.adjoint_degradation_op">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">adjoint_degradation_op</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_ker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#adjoint_degradation_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.adjoint_degradation_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply adjoint of the degradation operator <code class="docutils literal notranslate"><span class="pre">degradation_op</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.degradation_op">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">degradation_op</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_ker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#degradation_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.degradation_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift and decimate fine-grid image.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.handle_SExtractor_mask">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">handle_SExtractor_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#handle_SExtractor_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.handle_SExtractor_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle Sextractor masks.</p>
<p>Reads SExtracted star stamps, generates MCCD-compatible masks
(that is, binary weights), and replaces bad pixels with 0s -
they will not be used by MCCD, but the ridiculous numerical
values can otherwise still lead to problems because of convolutions.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.utils.match_psfs">
<code class="sig-prename descclassname"><span class="pre">mccd.utils.</span></code><code class="sig-name descname"><span class="pre">match_psfs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PSFs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/utils.html#match_psfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.utils.match_psfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Match psfs.DEPRECATED.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">MCCD.validation_stars</span></code> instead.
Takes as input the test_stars vignets and the PSFs vignets that were
outputs from the psf modelling method. The function outputs the PSFs
matching the corresponding test stars.
This allows to compute the pixel RMSE. Intended to be used with PSFEx
validation functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_stars</strong> (<em>numpy.ndarray</em>) – reg format (n_stars,n_pix,n_pix)</p></li>
<li><p><strong>PSFs</strong> (<em>numpy.ndarray</em>) – reg format (n_stars,n_pix,n_pix)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>deg_PSFs</strong> – reg format (n_stars,n_pix,n_pix)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mccd.proxs.html" class="btn btn-neutral float-left" title="1.1.6. mccd.proxs module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Tobias Liaudat.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>