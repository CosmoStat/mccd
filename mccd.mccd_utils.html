

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1.1.5. mccd.mccd_utils module &mdash; mccd 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1.1.6. mccd.proxs module" href="mccd.proxs.html" />
    <link rel="prev" title="1.1.4. mccd.mccd module" href="mccd.mccd.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mccd
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="mccd.html">1. mccd package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mccd.auxiliary_fun.html">1.1.1. mccd.auxiliary_fun module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.grads.html">1.1.2. mccd.grads module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.info.html">1.1.3. mccd.info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.mccd.html">1.1.4. mccd.mccd module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.1.5. mccd.mccd_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.proxs.html">1.1.6. mccd.proxs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mccd.utils.html">1.1.7. mccd.utils module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mccd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="mccd.html"><span class="section-number">1. </span>mccd package</a> &raquo;</li>
        
      <li><span class="section-number">1.1.5. </span>mccd.mccd_utils module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/mccd.mccd_utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mccd.mccd_utils">
<span id="mccd-mccd-utils-module"></span><h1><span class="section-number">1.1.5. </span>mccd.mccd_utils module<a class="headerlink" href="#module-mccd.mccd_utils" title="Permalink to this headline">¶</a></h1>
<p>MCCD UTILS.</p>
<p>These functions include several functions needed by the MCCD.</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Tobias Liaudat &lt;<a class="reference external" href="mailto:tobias&#46;liaudat&#37;&#52;&#48;cea&#46;fr">tobias<span>&#46;</span>liaudat<span>&#64;</span>cea<span>&#46;</span>fr</a>&gt;
Samuel Farrens &lt;<a class="reference external" href="mailto:samuel&#46;farrens&#37;&#52;&#48;cea&#46;fr">samuel<span>&#46;</span>farrens<span>&#64;</span>cea<span>&#46;</span>fr</a>&gt;</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>I added two functions from Pysap astro plugin and from ModOpt.signal.wavelet
so that I could replicate the functionv <code class="docutils literal notranslate"><span class="pre">get_mr_transform()</span></code> from ModOpt
without the need of having sparse2d installed as an exectubale by using
Pysap python bindings of the aforementioned C++ package.
Thanks Samuel Farrens (main developer of ModOpt and Pysap) for the help.</p>
<dl class="py function">
<dt id="mccd.mccd_utils.find_ccd_idx">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">find_ccd_idx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ccd_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccd_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#find_ccd_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.find_ccd_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the index of an element in a list.</p>
</dd></dl>

<dl class="py class">
<dt id="mccd.mccd_utils.Loc2Glob">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">Loc2Glob</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">425</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_npix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_npix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4612</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#Loc2Glob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.Loc2Glob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Change from local to global coordinates.</p>
<p>Class to pass from local coordinates to global coordinates under
CFIS (CFHT) MegaCam instrument. The geometrical informcation of the
instrument is encoded in this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_gap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Gap between the CCDs on the horizontal direction.
Default to <code class="docutils literal notranslate"><span class="pre">70</span></code> (CFIS value).</p></li>
<li><p><strong>y_gap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Gap between the CCDs on the vertical direction.
Default to <code class="docutils literal notranslate"><span class="pre">425</span></code> (CFIS value).</p></li>
<li><p><strong>x_npix</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of pixels on one CCD on the horizontal direction.
Default to <code class="docutils literal notranslate"><span class="pre">2048</span></code> (CFIS value).</p></li>
<li><p><strong>y_npix</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of pixels on one CCD on the vertical direction.
Default to <code class="docutils literal notranslate"><span class="pre">4612</span></code> (CFIS value).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>MegaCams geometry. Watch out with the conventions ba,ab that means where
is the local coordinate system origin for each CCD.
For more info look MegaCam’s instrument webpage.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;COMMENT (North on top, East to the left)&#39;</span><span class="p">,</span>
<span class="go">    &#39;COMMENT    --------------------------&#39;,</span>
<span class="go">    &#39;COMMENT    ba ba ba ba ba ba ba ba ba&#39;,</span>
<span class="go">    &#39;COMMENT    00 01 02 03 04 05 06 07 08&#39;,</span>
<span class="go">    &#39;COMMENT --------------------------------&#39;,</span>
<span class="go">    &#39;COMMENT ba ba ba ba ba ba ba ba ba ba ba&#39;,</span>
<span class="go">    &#39;COMMENT 36 09 10 11 12 13 14 15 16 17 37&#39;,</span>
<span class="go">    &#39;COMMENT --------------*-----------------&#39;,</span>
<span class="go">    &#39;COMMENT 38 18 19 20 21 22 23 24 25 26 39&#39;,</span>
<span class="go">    &#39;COMMENT ab ab ab ab ab ab ab ab ab ab ab&#39;,</span>
<span class="go">    &#39;COMMENT --------------------------------&#39;,</span>
<span class="go">    &#39;COMMENT    27 28 29 30 31 32 33 34 35&#39;,</span>
<span class="go">    &#39;COMMENT    ab ab ab ab ab ab ab ab ab&#39;,</span>
<span class="go">    &#39;COMMENT    __________________________&#39;</span>
</pre></div>
</div>
<p>Initialize with instrument geometry.</p>
<dl class="py method">
<dt id="mccd.mccd_utils.Loc2Glob.loc2glob_img_coord">
<code class="sig-name descname"><span class="pre">loc2glob_img_coord</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccd_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_coor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_coor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#Loc2Glob.loc2glob_img_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.Loc2Glob.loc2glob_img_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Go from the local to the global img (pixel) coordinate system.</p>
<p>Global system with (0,0) in the intersection of ccds [12,13,21,22].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ccd_n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – CCD number of the considered positions.</p></li>
<li><p><strong>x_coor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Local coordinate system hotizontal value.</p></li>
<li><p><strong>y_coor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Local coordinate system vertical value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>glob_x_coor</strong> (<em>float</em>) – Horizontal position in global coordinate system.</p></li>
<li><p><strong>glob_y_coor</strong> (<em>float</em>) – Vertical position in global coordinate system.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.Loc2Glob.flip_coord">
<code class="sig-name descname"><span class="pre">flip_coord</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccd_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_coor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_coor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#Loc2Glob.flip_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.Loc2Glob.flip_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Change of coordinate convention.</p>
<p>So that all of them are coherent on the global coordinate system.
So that the origin is on the south-west corner.
Positive: South to North ; West to East.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.Loc2Glob.shift_coord">
<code class="sig-name descname"><span class="pre">shift_coord</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccd_n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#Loc2Glob.shift_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.Loc2Glob.shift_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide the shifting.</p>
<p>It is needed to go from the local coordinate
system origin to the global coordinate system origin.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mccd.mccd_utils.MccdInputs">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">MccdInputs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_x_descriptor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'XWIN_IMAGE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_y_descriptor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'YWIN_IMAGE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Handle inputs for the MCCD algorithm.</p>
<p>This method was set up to work with a catalog outputed by SExtractor but
it should not be restricted to that.
The input files are generally created one per exposure per CCD.
Methods like PSFEx that build one model per exposure per CCD do not have
any preprocessing to do.
The MCCD method that uses all the stars in one exposure to build the
model needs to have only one file that will contain all the information
gathered in one exposure.
This is the main reason of this class, to be able to handle the
different CCD files from a particular exposure and integrate them in a
single file following the MCCD conventions, ie changing the local
coordinate system to the global one.
The expected files are in fits format.
An filename example would be: <code class="docutils literal notranslate"><span class="pre">star_selection-1234567-04.fits</span></code></p>
<blockquote>
<div><p>Where the exposure ID is: <code class="docutils literal notranslate"><span class="pre">1234567</span></code>
Where the CCD ID is: <code class="docutils literal notranslate"><span class="pre">04</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>separator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String separating the file names. Between the file pattern,
the exposure ID and the CCD ID.
Default is <code class="docutils literal notranslate"><span class="pre">'-'</span></code>.</p></li>
<li><p><strong>coord_x_descriptor</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of the fits column to be used as the horizontal
position coordinate.
Default is <code class="docutils literal notranslate"><span class="pre">'XWIN_IMAGE'</span></code>.</p></li>
<li><p><strong>coord_y_descriptor</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of the fits column to be used as the vertical position coordinate.
Default is <code class="docutils literal notranslate"><span class="pre">'YWIN_IMAGE'</span></code>.</p></li>
<li><p><strong>mask_thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Threshold to be used when constructing the masks.
SExtractor has the particular way of masking pixels by setting
pixels to the value -1e30.
Values beneath the threshold will be considered masked.
Default is <code class="docutils literal notranslate"><span class="pre">-1e5</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Initialize class attributes.</p>
<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.handle_mask">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">handle_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_to_stars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.handle_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.handle_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle and generate masks.</p>
<p>Reads SExtracted star stamps, generates MCCD-compatible masks
(that is, binary weights), and replaces bad pixels with 0s -
they will not be used by MCCD, but the ridiculous numerical
values can otherwise still lead to problems because of convolutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stars</strong> (<em>numpy.ndarray</em>) – Stars to be masked.</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Threshold that will define the mask.
Values below the threhsold will be considered masked.
Default is -1e5.</p></li>
<li><p><strong>apply_to_stars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Boolean to define if the stars should be thresholded
with <code class="docutils literal notranslate"><span class="pre">thresh</span></code> on top of the mask construction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.parse_path">
<code class="sig-name descname"><span class="pre">parse_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.parse_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.parse_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one path and extract info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Path to the file to be parsed in order to extract the
exposure ID and the CCD ID.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.parse_folder">
<code class="sig-name descname"><span class="pre">parse_folder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.parse_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.parse_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a folder that match a specfic <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p>Separate into a list of np.array each one for each starcat_id
present in the folder.
Each np.array in the list contains (starcat_id, ccd_n, path).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Path to the folder to be preprocessed.</p></li>
<li><p><strong>pattern</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – <code class="docutils literal notranslate"><span class="pre">pattern</span></code> to match on the files found in <code class="docutils literal notranslate"><span class="pre">folder_path</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.parse_pipeline_input_list">
<code class="sig-name descname"><span class="pre">parse_pipeline_input_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.parse_pipeline_input_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.parse_pipeline_input_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a pipeline input file list.</p>
<p>Separate into a list of np.array for each starcat_id
present in the folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_list</strong> (<em>list of str</em>) – List containing the path to all the files to be processed.</p></li>
<li><p><strong>element_position</strong> – The element to consider on the input list.
If there are multiple elements that share the name pattern and
the CCD ID, ie train/test, the element_position determines
which one will be used.
If there is only one element it should be 0.
Default is 0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">starcat_list</span></code> that is saved contains in each
element (starcat_id, ccd_n, path).</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.prep_mccd_inputs">
<code class="sig-name descname"><span class="pre">prep_mccd_inputs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starcat_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.prep_mccd_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.prep_mccd_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the inputs for mccd algorithm.</p>
<p>Taks done:</p>
<ul class="simple">
<li><p>Translate from local to global coordinate system.</p></li>
<li><p>Apply mask to stars.</p></li>
<li><p>Normalize star values.</p></li>
<li><p>Modify the star format.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>starcat_array</strong> (<em>numpy.ndarray</em>) – Array with (starcat_id, ccd_n, path) for every file in one
starcat_id (exposure ID).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>star_list</strong> (<em>list</em>) – List containing the masked star stamps.</p></li>
<li><p><strong>position_list</strong> (<em>list</em>) – List containing the positions in the global coordinate system.</p></li>
<li><p><strong>mask_list</strong> (<em>list</em>) – List containing the masks corresponding to the star stamps.</p></li>
<li><p><strong>ccd_list</strong> (<em>list</em>) – List containing the CCD ids for the stars.</p></li>
<li><p><strong>SNR_list</strong> (<em>list</em>) – List containing the estimated SNR values for the stars.
Will be None if there are no SNR values available.</p></li>
<li><p><strong>RA_list</strong> (<em>list</em>) – List containing the RA coordinate for the stars.
Will be None if there are no RA coordinates available.</p></li>
<li><p><strong>DEC_list</strong> (<em>list</em>) – List containing the DEC coordinate for the stars.
Will be None if there are no DEC coordinates available.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.preprocess_data">
<code class="sig-name descname"><span class="pre">preprocess_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.preprocess_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.preprocess_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Path to the folder containing the data files.</p></li>
<li><p><strong>pattern</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Pattern to match with the files in <code class="docutils literal notranslate"><span class="pre">folder_path</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>catalog_ids</strong> – List of exposure IDs preprocessed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.proprocess_pipeline_data">
<code class="sig-name descname"><span class="pre">proprocess_pipeline_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.proprocess_pipeline_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.proprocess_pipeline_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess Shapepipe pipeline’s input file list.</p>
<p>Also return the list of ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_list</strong> (<em>list of str</em>) – List containing the path to all the files to be processed.</p></li>
<li><p><strong>element_position</strong> – The element to consider on the input list.
If there are multiple elements that share the name
pattern and the CCD ID, ie train/test, the element_position
determines which one will be used.
If there is only one element it should be 0.
Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>catalog_ids</strong> – List of exposure IDs preprocessed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.get_inputs">
<code class="sig-name descname"><span class="pre">get_inputs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.get_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.get_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the MCCD inputs from a specific exposure id.</p>
<p>Returns several lists corresponding to the outputs of the
function <code class="docutils literal notranslate"><span class="pre">prep_mccd_inputs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>catalog_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Catalog id (exposure id) to be processed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.get_catalog_ids">
<code class="sig-name descname"><span class="pre">get_catalog_ids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.get_catalog_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.get_catalog_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Get preprocessed catalog ids.</p>
</dd></dl>

<dl class="py method">
<dt id="mccd.mccd_utils.MccdInputs.outlier_rejection">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">outlier_rejection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccd_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNR_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RA_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEC_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_std_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_fun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MccdInputs.outlier_rejection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MccdInputs.outlier_rejection" title="Permalink to this definition">¶</a></dt>
<dd><p>Outlier star rejection method.</p>
<p class="rubric">Notes</p>
<p>It is based on the measurements from Galsim’s HSM adaptive moments.
The method calculates the 2nd order moments from the stars
in the exposure. If there are stars that have an aberrant value in one
of the stats, e1, e2 or R2 we discard the star.
An aberrant value is defined as a value that is more
than <code class="docutils literal notranslate"><span class="pre">shape_std_max</span></code> sigmas away from the mean.</p>
<p>It inputs all the lists that will be used as a method and returns
the same lists without the stars that where considered as outliers.</p>
<p><code class="docutils literal notranslate"><span class="pre">print_fun</span></code> is a function that prints details about the stars
being removed.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.random_indexes">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">random_indexes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_tot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_per</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#random_indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.random_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random indexes to separate datasets.</p>
<p>Separate datasets into train and test sets following some criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_tot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Total number of elements.</p></li>
<li><p><strong>train_per</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Percentage of those elements to be used for train.
Default is 0.8.</p></li>
<li><p><strong>min_n_train</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Minimum number of elements that should be used for training.
Default is 20.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>train_idx</strong> (<em>numpy.ndarray</em>) – Array of random indexes used for the training.</p></li>
<li><p><strong>test_idx</strong> (<em>numpy.ndarray</em>) – Array of random indexes used for the testing.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.save_to_fits">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">save_to_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#save_to_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.save_to_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Save dictionary of numpy.ndarray into a fits file.</p>
<p><code class="docutils literal notranslate"><span class="pre">output_path</span></code> should be the path + new_name to save the fits and should
include <code class="docutils literal notranslate"><span class="pre">.fits</span></code> extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary to be saved to the fits file.</p></li>
<li><p><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Should be the concatenation of the path to the folder and the name
of the new fits file and should include <code class="docutils literal notranslate"><span class="pre">.fits</span></code> extension.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>It is important that all the numpy.ndarrays share the first dimension as
we are saving a table.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.save_fits">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">save_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#save_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.save_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Save fits file.</p>
<p>Save a dictionary into a fits file format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary containing the data to be saved.</p></li>
<li><p><strong>train_bool</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Bool to determine if it will be a training catalog or a testing
catalog.
Changes the name pattern used for the file.</p></li>
<li><p><strong>cat_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Catalog id (exposure id) to be added in the file name.</p></li>
<li><p><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Path to folder to save the new file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.return_loc_neighbors">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">return_loc_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#return_loc_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.return_loc_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Find nearest neighbors locally in one CCD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_pos</strong> (<em>numpy.ndarray</em>) – Array containing the new target position (x,y).</p></li>
<li><p><strong>obs_pos</strong> (<em>numpy.ndarray</em>) – Array containing the positions of the training stars.</p></li>
<li><p><strong>vals</strong> (<em>numpy.ndarray</em>) – Values that will be used to interpolate and need to be extracted.</p></li>
<li><p><strong>n_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of closest neighbors to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>nbs</strong> (<em>numpy.ndarray</em>) – Values from <code class="docutils literal notranslate"><span class="pre">vals</span></code> of the closest <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> from <code class="docutils literal notranslate"><span class="pre">new_pos</span></code>.</p></li>
<li><p><strong>pos</strong> (<em>numpy.ndarray</em>) – Positions of the closest <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> from <code class="docutils literal notranslate"><span class="pre">new_pos</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.return_glob_neighbors">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">return_glob_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_pos_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#return_glob_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.return_glob_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Find nearest neighbors locally in all the available CCDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_pos</strong> (<em>numpy.ndarray</em>) – Array containing the new target position (x,y).</p></li>
<li><p><strong>obs_pos_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List containing the positions of the training stars from all the CCDs.</p></li>
<li><p><strong>val_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List containing the values from all the CCDs that will be used to
interpolate and need to be extracted.</p></li>
<li><p><strong>n_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of closest neighbors to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>values</strong> (<em>numpy.ndarray</em>) – Values from <code class="docutils literal notranslate"><span class="pre">vals</span></code> of the closest <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> from <code class="docutils literal notranslate"><span class="pre">new_pos</span></code>.</p></li>
<li><p><strong>positions</strong> (<em>numpy.ndarray</em>) – Positions of the closest <code class="docutils literal notranslate"><span class="pre">n_neighbors</span></code> from <code class="docutils literal notranslate"><span class="pre">new_pos</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.interpolation_Pi">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">interpolation_Pi</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_comp_glob</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#interpolation_Pi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.interpolation_Pi" title="Permalink to this definition">¶</a></dt>
<dd><p>Create polynomial interpolation Pi matrix.</p>
<p>Create a Pi matrix list that will be used for the interpolation
of the global model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List containing the all the positions of the training stars.</p></li>
<li><p><strong>d_comp_glob</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Maximum polynomial degree to be used for the Pi matrix construction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>interp_Pi</strong> – List containing all the Pi polynomial matrices, one for each
CCD (object in the position list).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.trim_filter">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">trim_filter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#trim_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.trim_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim the filters to the minimal size.</p>
<p>This method will get rid of the extra zero coefficients in the filter.
:param filter_array: The filter to be trimmed
:type filter_array: numpy.ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Trimmed filter</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Function copied from ModOpt.signal.wavelet as we need it to
replicate ModOpt’s <code class="docutils literal notranslate"><span class="pre">get_mr_filters()</span></code> but
using the wavelet transforms from Pysap.</p>
</dd></dl>

<dl class="py function">
<dt id="mccd.mccd_utils.get_mr_filters">
<code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">get_mr_filters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#get_mr_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.get_mr_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get transform filters.</p>
<p>This method obtains wavelet filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – 2D data shape</p></li>
<li><p><strong>opt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of wavelet transform (in Pysap convention, see Notes)</p></li>
<li><p><strong>n_scales</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of transform scales.
Default is <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p></li>
<li><p><strong>coarse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to keep coarse scale.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>trim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Option to trim the filters down to their minimal size
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray 3D array of wavelet filters.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Function copied from Pysap package’s astro plugin.
Added the trim_filter() functionality from the ModOpt package.
The name of the wavelet transform must be in Pysap convention that
differs from the sparse2d input arguments.
To see the available transforms in Pysap, you need to import the
python module (<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pysap</span></code>) and then call
<code class="docutils literal notranslate"><span class="pre">pysap.AVAILABLE_TRANSFORMS</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt id="mccd.mccd_utils.MomentInterpolator">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mccd.mccd_utils.</span></code><code class="sig-name descname"><span class="pre">MomentInterpolator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moment_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbf_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'thin_plate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MomentInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MomentInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Allow to interpolate moments from a bin image.</p>
<p>Bin image like the one from the MeanShapes function.</p>
<p class="rubric">Notes</p>
<p>Not used for the moment.</p>
<p>Initialize class attributes.</p>
<dl class="py method">
<dt id="mccd.mccd_utils.MomentInterpolator.interpolate_position">
<code class="sig-name descname"><span class="pre">interpolate_position</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mccd/mccd_utils.html#MomentInterpolator.interpolate_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mccd.mccd_utils.MomentInterpolator.interpolate_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate positions.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mccd.proxs.html" class="btn btn-neutral float-right" title="1.1.6. mccd.proxs module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mccd.mccd.html" class="btn btn-neutral float-left" title="1.1.4. mccd.mccd module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Tobias Liaudat.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>